[gd_scene load_steps=16 format=3 uid="uid://siguvig7u465"]

[ext_resource type="Script" path="res://scripts/reset_manager.gd" id="1_e3wct"]
[ext_resource type="Script" path="res://scripts/shaky_camera.gd" id="1_hje18"]
[ext_resource type="Script" path="res://scripts/game_manager.gd" id="1_imn7p"]
[ext_resource type="Script" path="res://scripts/physics/balls/player_controller.gd" id="1_m3mpd"]
[ext_resource type="Script" path="res://scripts/physics/stage_limits.gd" id="1_s5gh3"]
[ext_resource type="Script" path="res://scripts/physics/balls/physics_ball_manager.gd" id="1_vyn2h"]
[ext_resource type="Script" path="res://scripts/physics/beam/time_dependant_balance_beam.gd" id="2_k61rr"]
[ext_resource type="Script" path="res://scripts/drawing/path_drawing/character_drawer.gd" id="2_radw7"]
[ext_resource type="Script" path="res://scripts/drawing/path_drawing/squishy_path_set_drawer.gd" id="3_mencq"]
[ext_resource type="Shader" path="res://visuals/shaders/waves.gdshader" id="10_6n8yc"]
[ext_resource type="Shader" path="res://visuals/shaders/distorted_waves.gdshader" id="10_vve22"]
[ext_resource type="Script" path="res://scripts/physics/distorted_water.gd" id="11_w0r1a"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_lb16j"]
shader = ExtResource("10_vve22")
shader_parameter/water_level = 60.0
shader_parameter/outline_colour = Color(1.25, 1.25, 1.25, 0.9)
shader_parameter/outline_width = 2.5
shader_parameter/amplitude_1 = 2.4
shader_parameter/frequency_1 = 3.2
shader_parameter/wavelength_1 = -120.0
shader_parameter/amplitude_2 = 2.0
shader_parameter/frequency_2 = -7.11
shader_parameter/wavelength_2 = 200.0
shader_parameter/screen_resolution = Vector2i(240, 135)
shader_parameter/screen_margin = 0.25
shader_parameter/p1_distortion_point = Vector2(-40, 0)
shader_parameter/p2_distortion_point = Vector2(40, 80)
shader_parameter/distortion_radius = 30.0
shader_parameter/p1_distortion_amount = 1.0
shader_parameter/p2_distortion_amount = 1.0

[sub_resource type="QuadMesh" id="QuadMesh_b4cbx"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_e3hm2"]
shader = ExtResource("10_6n8yc")
shader_parameter/water_level = 60.0
shader_parameter/outline_colour = Color(1.25, 1.25, 1.25, 0.9)
shader_parameter/outline_width = 1.5
shader_parameter/amplitude_1 = 1.5
shader_parameter/frequency_1 = -4.67
shader_parameter/wavelength_1 = -80.0
shader_parameter/amplitude_2 = 1.2
shader_parameter/frequency_2 = 8.76
shader_parameter/wavelength_2 = -180.0
shader_parameter/screen_resolution = Vector2i(240, 135)
shader_parameter/screen_margin = 0.25

[node name="Game" type="Node2D" node_paths=PackedStringArray("reset_manager", "stage_limits")]
texture_filter = 1
script = ExtResource("1_imn7p")
reset_manager = NodePath("ResetManager")
stage_limits = NodePath("StageLimits")

[node name="Camera2D" type="Camera2D" parent="." node_paths=PackedStringArray("ball_manager", "balance_beam")]
script = ExtResource("1_hje18")
ball_manager = NodePath("../PhysicsBallManager")
balance_beam = NodePath("../Beam")

[node name="ResetManager" type="Node2D" parent="." node_paths=PackedStringArray("ball_manager", "balance_beam")]
script = ExtResource("1_e3wct")
ball_manager = NodePath("../PhysicsBallManager")
balance_beam = NodePath("../Beam")
reset_duration = 0.8

[node name="StageLimits" type="Node2D" parent="."]
script = ExtResource("1_s5gh3")

[node name="Beam" type="Node2D" parent="."]
z_index = 1
position = Vector2(0, 40)
script = ExtResource("2_k61rr")
velocity_multiplier_increase_per_second = 2.0
shrink_delay = 6.0
shrink_amount = 40.0
shrink_tween_duration = 0.2
shrink_tween_easing = 2
shrink_tween_transition_type = 10
fill_colour = Color(0.4, 0.4, 0.4, 1)
stroke_width = 1.5
ball_mass = 0.25

[node name="PhysicsBallManager" type="Node2D" parent="."]
script = ExtResource("1_vyn2h")
collision_elasticity = 0.6
minimum_collision_speed = 0.1

[node name="Player1" type="Node2D" parent="PhysicsBallManager"]
position = Vector2(-40, -20)
script = ExtResource("1_m3mpd")
strafe_force = 12.0
charged_squish_ratio = 0.5
jump_speed = 6.0
jump_charge_period = 0.15
drop_force = 16.0
max_squish_ratio = 0.35
gravity = 15.0
radius = 12.0
minimum_bounce_speed = Vector2(2, 0.5)

[node name="Drawer" type="Node2D" parent="PhysicsBallManager/Player1" node_paths=PackedStringArray("path_set_drawer")]
script = ExtResource("2_radw7")
file_path = "res://visuals/characters/a.svg"
path_set_drawer = NodePath("PathSetDrawer")
fill_colour = Color(0.564706, 0.611765, 0.917647, 1)
stroke_colour = Color(0.431373, 0.458824, 0.890196, 1)
radius = 12.0

[node name="PathSetDrawer" type="Node2D" parent="PhysicsBallManager/Player1/Drawer"]
z_index = 1
z_as_relative = false
script = ExtResource("3_mencq")

[node name="Player2" type="Node2D" parent="PhysicsBallManager"]
position = Vector2(40, -20)
script = ExtResource("1_m3mpd")
player_index = 2
strafe_force = 12.0
charged_squish_ratio = 0.5
jump_speed = 6.0
jump_charge_period = 0.15
drop_force = 16.0
max_squish_ratio = 0.35
gravity = 15.0
radius = 12.0
minimum_bounce_speed = Vector2(2, 0.5)

[node name="Drawer" type="Node2D" parent="PhysicsBallManager/Player2" node_paths=PackedStringArray("path_set_drawer")]
script = ExtResource("2_radw7")
file_path = "res://visuals/characters/joker.svg"
path_set_drawer = NodePath("PathSetDrawer")
fill_colour = Color(0.368627, 0.321569, 0.247059, 0.701961)
stroke_colour = Color(0.219608, 0.211765, 0.254902, 1)
radius = 12.0

[node name="PathSetDrawer" type="Node2D" parent="PhysicsBallManager/Player2/Drawer"]
z_index = 2
z_as_relative = false
script = ExtResource("3_mencq")

[node name="Water" type="Node2D" parent="."]
modulate = Color(0.387, 0.631383, 0.86, 1)

[node name="Front" type="MeshInstance2D" parent="Water"]
z_index = 5
material = SubResource("ShaderMaterial_lb16j")
mesh = SubResource("QuadMesh_b4cbx")
script = ExtResource("11_w0r1a")
distortion_threshold = 60.0
splash_particle_lifetime = 1.6
splash_particle_velocity_multiplier = 0.9
splash_particle_offset = Vector2(0, -10)
splash_particle_bouyancy = 10.0
splash_particle_friction_per_submergence = 0.05

[node name="Back" type="MeshInstance2D" parent="Water"]
modulate = Color(0.8, 0.8, 0.8, 1)
z_index = -5
material = SubResource("ShaderMaterial_e3hm2")
mesh = SubResource("QuadMesh_b4cbx")

[connection signal="bottom_threshold_reached" from="StageLimits" to="Water/Front" method="_on_stage_limits_bottom_threshold_reached"]
